<!DOCTYPE html>
<html lang="en">
<head>
		<!-- Bootstrap CSS -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
		<style>
			.modal-backdrop.show { z-index: 2050 !important; }
			.modal { z-index: 2100 !important; }
		</style>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<title>ROI - Marketing & Technology Agency</title>
    <link rel="icon" type="image/png" href="../images/logo.png">
	<link rel="stylesheet" href="./dashboard.css">
	<link rel="stylesheet" href="../styles.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
		<!-- Logout Confirmation Modal -->
		<div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">
					<div class="modal-header border-0" style="justify-content:center;">
						<h5 class="modal-title w-100 text-center" id="logoutModalLabel" style="font-weight:700;">Logout Confirmation</h5>
						<button type="button" class="btn-close position-absolute end-0 me-3" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body text-center" style="font-size:1.15rem; color:#222; padding:24px 12px 12px 12px;">
						<i class="fa fa-sign-out-alt" style="font-size:2.2rem; color:#2ca6a4; margin-bottom:12px;"></i><br>
						Are you sure you want to logout?
					</div>
					<div class="modal-footer border-0" style="justify-content:center; gap:18px; padding-bottom:24px;">
						<button type="button" class="btn btn-secondary px-4" data-bs-dismiss="modal" style="border-radius:8px;">Cancel</button>
						<button type="button" class="btn btn-primary px-4" id="confirmLogout" style="border-radius:8px; background:#218a8a; border:none;">Yes</button>
					</div>
				</div>
			</div>
		</div>

		<!-- Delete Confirmation Modal -->
		<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">
					<div class="modal-header border-0" style="justify-content:center;">
						<h5 class="modal-title w-100 text-center" id="deleteModalLabel" style="font-weight:700;">Delete Email</h5>
						<button type="button" class="btn-close position-absolute end-0 me-3" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body text-center" id="deleteModalBody" style="font-size:1.15rem; color:#222; padding:24px 12px 12px 12px;">
						<i class="fa fa-trash" style="font-size:2.2rem; color:#d9534f; margin-bottom:12px;"></i><br>
						Do you want to delete?
					</div>
					<div class="modal-footer border-0" style="justify-content:center; gap:18px; padding-bottom:24px;">
						<button type="button" class="btn btn-secondary px-4" data-bs-dismiss="modal" style="border-radius:8px;">Cancel</button>
						<button type="button" class="btn btn-danger px-4" id="confirmDelete" style="border-radius:8px; background:#d9534f; border:none;">Yes</button>
					</div>
				</div>
			</div>
		</div>

		<div class="dashboard-container">
		<!-- Sidebar -->
		<aside class="sidebar">
			<div class="sidebar-content">
				<div class="sidebar-header">
					<img src="../images/logo.png" alt="Company Logo" class="company-logo">
					<h2>ROYAL ORBIT<br>INNOVATIONS</h2>
				</div>
				<nav class="sidebar-nav">
					<ul>
                        <li><a href="/admin/dashboard" style="color:inherit;text-decoration:none;display:flex;align-items:center;"><i class="fa fa-th-large"></i> Dashboard</a></li>
						<li class="active"><i class="fa fa-envelope"></i> Emails</li>
						<li><a href="/admin/blog" style="color:inherit;text-decoration:none;display:flex;align-items:center;"><i class="fa fa-blog"></i> Blogs</a></li>
						<li><a href="/admin/clients" style="color:inherit;text-decoration:none;display:flex;align-items:center;"><i class="fa fa-users"></i> Clients</a></li>
						<li><a href="/admin/services" style="color:inherit;text-decoration:none;display:flex;align-items:center;"><i class="fa fa-cogs"></i> Services</a></li>
						<li><a href="/admin/client-projects" style="color:inherit;text-decoration:none;display:flex;align-items:center;"><i class="fa fa-project-diagram"></i> Client Projects</a></li>
						<li><a href="/admin/industries" style="color:inherit;text-decoration:none;display:flex;align-items:center;"><i class="fa fa-industry"></i> Industries</a></li>
					</ul>
				</nav>
			</div>
			<div class="sidebar-bottom">
				<ul>
					<li><a href="/admin/setting" style="color:inherit;text-decoration:none;display:flex;align-items:center;"><i class="fa fa-user-cog"></i> Setting</a></li>
					<li id="logoutBtn" style="cursor:pointer;"><i class="fa fa-sign-out-alt"></i> Logout</li>
				</ul>
			</div>
		</aside>

		<!-- Main Content -->
		<main class="main-panel">
			<!-- Top Bar -->
			<div class="top-bar">
				<h1>Email</h1>
				<div class="top-bar-right">
					<div class="search-bar">
						<input type="text" placeholder="Search mail">
						<button><i class="fa fa-search"></i></button>
					</div>
					<div class="admin-profile">
						<img src="../images/man.png" alt="Admin" class="profile-pic">
						<span>Mr. Kaleel</span>
					</div>
				</div>
			</div>

			<!-- Email View Panel -->
			<div class="email-panel" style="background:#fff; border-radius:20px; margin-top:20px; margin-left:0; margin-right:0; width:100%; max-width:none; box-shadow:0 2px 12px rgba(44,166,164,0.06); padding:32px 0 0 0;">
				<div style="padding:0 32px 16px 32px;">
					<div style="display:flex; align-items:center; justify-content:space-between;">
						<div class="search-bar" style="flex:1; max-width:340px;">
								<input type="text" id="emailSearch" placeholder="Search mail" style="width:100%;">
								<button onclick="filterEmails()"><i class="fa fa-search"></i></button>
						</div>
						<div style="display:flex; gap:16px;">
							<button style="background:none; border:none; font-size:1.2rem; cursor:pointer;"><i class="fa fa-star"></i></button>
							<button id="deleteAllBtn" style="background:none; border:none; font-size:1.2rem; cursor:pointer;"><i class="fa fa-trash"></i></button>
						</div>
					</div>
				</div>
				<table style="width:100%; border-collapse:collapse;">
					<tbody id="emailsTableBody">
					</tbody>
				</table>
<!-- Only keep one script block below -->
				<!-- Only one chevron button, right for next page -->
				<div style="display:flex; justify-content:flex-end; align-items:center; gap:8px; padding:16px 32px;">
					<button style="background:none; border:none; font-size:1.2rem; cursor:pointer;"><i class="fa fa-chevron-left"></i></button>
					<button style="background:none; border:none; font-size:1.2rem; cursor:pointer;"><i class="fa fa-chevron-right"></i></button>
				</div>
			</div>
		</main>
	</div>
<script>
const emails = [
	{ name: "Julu Jalal", subject: "Our Bachelor of Commerce program is ACBSP-accredited.", time: "8:38 AM", star: "#ccc" },
	{ name: "Minerva Barnett", subject: "Get Best Advertiser In Your Side Pocket", time: "8:13 AM", star: "#ccc" },
	{ name: "Peter Lewis", subject: "Vacation Home Rental Success", time: "7:52 PM", star: "#ccc" },
	{ name: "Anthony Briggs", subject: "Free Classifieds Using Them To Promote Your Stuff Online", time: "7:52 PM", star: "#FFD700" },
	{ name: "Clifford Morgan", subject: "Enhance Your Brand Potential With Giant Advertising Blimps", time: "4:13 PM", star: "#ccc" },
	{ name: "Cecilia Webster", subject: "Always Look On The Bright Side Of Life", time: "3:52 PM", star: "#ccc" },
	{ name: "Harvey Manning", subject: "Curling Irons Are As Individual As The Women Who Use Them", time: "2:30 PM", star: "#FFD700" },
	{ name: "Willie Blake", subject: "Our Bachelor of Commerce program is ACBSP-accredited.", time: "8:38 AM", star: "#ccc" },
	{ name: "Minerva Barnett", subject: "Get Best Advertiser In Your Side Pocket", time: "8:13 AM", star: "#ccc" },
	{ name: "Fanny Weaver", subject: "Free Classifieds Using Them To Promote Your Stuff Online", time: "7:52 PM", star: "#ccc" },
	{ name: "Olga Hogan", subject: "Enhance Your Brand Potential With Giant Advertising Blimps", time: "4:13 PM", star: "#ccc" }
];

let deleteType = null; // 'selected' or 'all'
let selectedIndexes = [];
function attachTrashListener() {
	const trashBtn = document.getElementById('deleteAllBtn');
	if (trashBtn) {
		trashBtn.onclick = function() {
			selectedIndexes = Array.from(document.querySelectorAll('#emailsTableBody input[type="checkbox"]:checked')).map(cb => parseInt(cb.getAttribute('data-index')));
			var deleteModalEl = document.getElementById('deleteModal');
			var deleteModalBody = document.getElementById('deleteModalBody');
			var deleteModal = new bootstrap.Modal(deleteModalEl);
			if (selectedIndexes.length > 0) {
				deleteType = 'selected';
				deleteModalBody.innerHTML = `<i class='fa fa-trash' style='font-size:2.2rem; color:#d9534f; margin-bottom:12px;'></i><br>Do you want to delete the selected email(s)?`;
			} else {
				deleteType = 'all';
				deleteModalBody.innerHTML = `<i class='fa fa-trash' style='font-size:2.2rem; color:#d9534f; margin-bottom:12px;'></i><br>Do you want to delete all?`;
			}
			deleteModal.show();
		};
	}
}

function renderEmails(list) {
	const tbody = document.getElementById('emailsTableBody');
	tbody.innerHTML = '';
	list.forEach((e, i) => {
		tbody.innerHTML += `<tr style='border-bottom:1px solid #eee;'>
			<td style='padding:12px 32px;'><input type='checkbox' data-index='${i}'></td>
			<td style='padding:12px 0;'><i class='fa fa-star' style='color:${e.star};'></i></td>
			<td style='font-weight:600;'>${e.name}</td>
			<td>${e.subject}</td>
			<td style='text-align:right; padding-right:32px; color:#888;'>${e.time}</td>
		</tr>`;
	});
	attachTrashListener();
}

function filterEmails() {
	const search = document.getElementById('emailSearch').value.toLowerCase();
	renderEmails(emails.filter(e => e.name.toLowerCase().includes(search) || e.subject.toLowerCase().includes(search)));
}

document.getElementById('emailSearch').addEventListener('input', filterEmails);
window.onload = function() {
	renderEmails(emails);
};

// Delete modal logic
document.addEventListener('DOMContentLoaded', function() {
	var confirmDelete = document.getElementById('confirmDelete');
	confirmDelete.addEventListener('click', function() {
		if (deleteType === 'selected' && selectedIndexes.length > 0) {
			// Remove selected emails
			selectedIndexes.sort((a, b) => b - a).forEach(idx => emails.splice(idx, 1));
			renderEmails(emails);
		} else if (deleteType === 'all') {
			emails.length = 0;
			renderEmails(emails);
		}
		selectedIndexes = [];
		deleteType = null;
		// Always hide the modal using the static method
		var deleteModalEl = document.getElementById('deleteModal');
		var modalInstance = bootstrap.Modal.getInstance(deleteModalEl);
		if (modalInstance) {
			modalInstance.hide();
		} else {
			// fallback: manually remove 'show' class and backdrop
			deleteModalEl.classList.remove('show');
			deleteModalEl.setAttribute('aria-hidden', 'true');
			document.body.classList.remove('modal-open');
			let backdrop = document.querySelector('.modal-backdrop');
			if (backdrop) backdrop.remove();
		}
	});
});
</script>
<!-- Removed duplicate chevron navigation and extra scrollable area -->
			</div>
		</main>
	</div>
</body>
	<!-- Chart.js for graph -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<!-- Bootstrap JS (must be last) -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
	<script>
		document.addEventListener('DOMContentLoaded', function() {
			// Logout modal logic
			var logoutBtn = document.getElementById('logoutBtn');
			var logoutModalEl = document.getElementById('logoutModal');
			var confirmLogout = document.getElementById('confirmLogout');
			var logoutModal = new bootstrap.Modal(logoutModalEl);
			logoutBtn.addEventListener('click', function() {
				logoutModal.show();
			});
			confirmLogout.addEventListener('click', function() {
				window.location.href = '../';
			});
		});
	</script>
</html>
